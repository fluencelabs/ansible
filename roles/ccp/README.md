# fluencelabs.provider.ccp

Install and configure
[ccp](https://github.com/fluencelabs/capacity-commitment-peer/) - Fluence
capacity-commitment-prover

## Usage

See this [example](https://github.com/fluencelabs/ansible/blob/main/example/)

### Cleanup ccp state

Rerun playbook with flag `ccp_cleanup` set to `true`:

```bash
ansible-playbook ccp.yml -e ccp_cleanup=true
```

### Install ccp snapshot from PR

```bash
ansible-playbook ccp.yml -e "ccp_branch=FLU-668"
```

### Uninstall ccp

Run role with tag `uninstall`:

```bash
ansible-playbook ccp.yml --tags uninstall
```

## Role Variables

See
[defaults/](https://github.com/fluencelabs/ansible/blob/main/roles/ccp/defaults)
for details and examples.

#### `fluence_project_dir`

- directory that contains provider settings, configs and secrets generated by
  [Fluence CLI](https://github.com/fluencelabs/cli) from `provider.yaml` config.
  Shared in collection.
- type: string

Should be put to `files/` directory where you run this role.

#### `fluence_instance_id`

- instance id to assing to target. Shared in collection.
- type: string

#### `fluence_cleanup` or `ccp_cleanup`

- Cleanup ccp state and restart ccp.
- type: bool

#### `ccp_version`

- version of ccp
- type: string

#### `ccp_dir`

- root ccp directory
- type: string
- default:
  ```yml
  ccp_dir: "/opt/fluence/ccp"
  ```

It will contain everything this role creates: ccp binaries, configs and state.

#### `ccp_unit_file`

- systemd unit file
- type: string
- default: see
  [defaults/main.yml](https://github.com/fluencelabs/blob/main/roles/ccp/defaults/main.yml)

#### `ccp_user`

- owner of ccp process and files
- type: string
- default:
  ```yml
  ccp_user: "ccp"
  ```

#### `ccp_group`

- group of `ccp_user`
- type: string
- default:
  ```yml
  ccp_group: "ccp"
  ```

#### `ccp_branch`

- type: string

## Role Tags

- `cleanup` - stop ccp and cleanup state

## Author

- **Anatolios Laskaris** - [nahsi](https://github.com/nahsi)
