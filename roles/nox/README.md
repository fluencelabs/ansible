# fluencelabs.provider.nox

Install and configure [Nox](https://github.com/fluencelabs/nox/) - Rust
implementation of the Fluence network peer.

## Usage

See this [example](https://github.com/fluencelabs/ansible/blob/main/example/)

### Cleanup nox state

Rerun playbook with flag `nox_cleanup` set to `true`:

```bash
ansible-playbook nox.yml -e nox_cleanup=true
```

### Install nox snapshot from PR

```bash
ansible-playbook nox.yml -e "nox_branch=FLU-688"
```

### Uninstall nox

Run role with tag `uninstall`:

```bash
ansible-playbook nox.yml --tags uninstall
```

## Role Variables

See
[defaults/](https://github.com/fluencelabs/ansible/blob/main/roles/nox/defaults)
for details and examples.

#### `fluence_project_dir`

- directory that contains provider settings, configs and secrets generated by
  [Fluence CLI](https://github.com/fluencelabs/cli) from `provider.yaml` config.
  Shared in collection.
- type: string

Should be put to `files/` directory where you run this role.

#### `fluence_instance_id`

- instance id to assing to target. Shared in collection.
- type: string

#### `fluence_cleanup` or `nox_cleanup`

- Cleanup nox state and restart nox.
- type: bool

#### `nox_version`

- version of nox
- type: string

#### `nox_dir`

- root nox directory
- type: string
- default:
  ```yml
  nox_dir: "/opt/fluence/nox"
  ```

It will contain everything this role creates: nox binaries, configs, secrets.

#### `nox_local_backup_dir`

- local directory with archive backups of nox secrets
- type: string
- default:

```yml
nox_local_backup_dir: "files/{{ fluence_project_dir }}/backups"
```

#### `nox_unit_file`

- systemd unit file
- type: string
- default: see
  [defaults/main.yml](https://github.com/fluencelabs/blob/main/roles/nox/defaults/main.yml)

#### `nox_user`

- owner of Nox process and files
- type: string
- default:
  ```yml
  nox_user: "nox"
  ```

#### `nox_group`

- group of `nox_user`
- type: string
- default:
  ```yml
  nox_group: "nox"
  ```

#### `nox_branch`

- whole catalogue of branches can be viewed here
  https://files.fluence.dev/buckets/fluence-artifacts

- type: string

## Role Tags

- `uninstall` - stop nox and delete nox directory

## Author

- **Anatolios Laskaris** - [nahsi](https://github.com/nahsi)
